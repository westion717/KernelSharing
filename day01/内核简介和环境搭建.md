###内容概述
---
- 内容简介
	- 内核工作简介
		- CPU管理
		- 内存管理
		- 其他硬件资源管理
- 开发环境准备
	- 虚拟机安装
	- 安装Linux（本机是Linux可跳过）
	- 开发工具安装

###知识点分析
---
- 内核工作简介  
内核是一个操作系统的核心，用来管理硬件提供的资源。  
	- CPU管理  
		系统中最重要的资源当然是CPU了。在多任务系统中，内核要管理CPU在每个任务上的执行时间。内核给每个任务分配一个**时间片**，来控制每个任务运行的时间。当时间片结束，系统时钟会通过**中断**来通知内核，内核中断当前的进程，并调度别的进程来使用CPU。或是当前进程主动放弃时间片进入阻塞状态，也会重新调度进程。以达到分时操作系统的目的。在任务的调度中会有一些算法被使用，来决定下一个使用CPU的进程是哪个。具体算法这里不做细述。

	- 内存管理  
		系统中第二重要的资源就是内存了。CPU运行的数据需从内存中获取，以弥补CPU的高速特性。我们需要CPU更高效的工作，就需要把更多的数据存在内存，而我们的内存又是有限的。所以内存的管理就非常重要。这也是内核非常重要的工作之一。
	- 其他硬件资源管理
		- DMA
		- 中断控制器（IRQ）
		- Keyboard
		- 声卡、网卡等

		这类硬件资源还有很多，不能一一列举和介绍，有些在后续内容中有具体介绍

- 开发环境准备
	- 宿主机（Host）  
	开发内核的PC机，类Unix系统（Linux，FreeBSD，Unix等），X86架构，建议32位，省去一定麻烦。**64位也行，相关操作时需要加上32位操作参数**（本教程用虚拟机实现）

	- 目标机（Target）  
	内核运行的PC机，用VirtualBox，VMware或者Bochs虚拟。建议用VirtualBox，开源。（用真机也行）

	- 相关工具
		- C编译器
			+ GCC（The GNU C Compiler，32位）
		- 链接器
			+ ld（32位）
		- 汇编器（X86）
			+ NASM（32位）
		- 文本编辑器
			+ Vim 
		- 虚拟机
			+ VirtualBox
		- 其他工具
			+ mkisofs（制作iso镜像）
			+ GRUB（内核引导工具）
	- Internet
		+ Google (查询资料)

###具体操作
---

- 下载VirtualBox并安装，下载地址**[此处](http://w.x.baidu.com/alading/anquan_soft_down_normal/15321)**(Windows)
- 新建虚拟机，并安装Linux，本教程使用Ubuntu13.10,32位，desktop版。由于Ubuntu官网只看到稳定的12.04版**[下载地址](http://releases.ubuntu.com/12.04/ubuntu-12.04.4-desktop-i386.iso.torrent)**，所以13.10需要自己想办法下载，但是12.04对本教程并没有影响，所以使用12.04即可。安装过程参考  
**[http://teliute.org/linux/Ubsetup/lesson21/lesson21.html](http://teliute.org/linux/Ubsetup/lesson21/lesson21.html)**  
不再详述
- Linux安装完后安装工具。命令如下
	
		sudo apt-get install nasm vim grub 


###注意提醒
---

- 如果本机已经是Linux那么就只需要用虚拟机构建出目标机即可
- 选择32位平台是因为NASM汇编器产生的代码是32位的，并且32位的寻址方式比较简单，CPU从i386之后就开始32位寻址，具有教学典型
- 选择NASM汇编器，因为语法比较简单，且开源
- 由于Ubuntu的desktop版，默认自带了gcc，ld，mkisofs命令所以只需安装grub，nasm和Vim三个工具。若果别的系统没有安装则自行安装
- Vim作为可选编辑器，也可以使用别的编辑器，如Gedit，Sublime
- GRUB（Grand Unified Bootloader）之后将详细介绍
- 内核对除了CPU和内存之外的硬件管理是通过操作硬件的**接口**完成的。而操作接口的方法就是通过**端口**向接口中的**寄存器**写入数值，从而实现操控接口